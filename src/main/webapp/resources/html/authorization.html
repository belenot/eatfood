<!doctype html>
<html>
  <head>
    <title>authorization</title>
    <link rel="stylesheet" type="text/css" href="/eatfood/authorization.css">
  </head>
  <body>
    <h1>Authorization</h1>
    <form onsubmit="logIn(event);" id="auth-form">
      <div>
	<label for="login">&#9998;Login</label>
	<input type="text" name="login">
      </div>
      <div>
	<label for="password">&#9998;Password</label>
	<input type="password" name="password">
      </div>
      <div>
	<input type="submit" class="b-btn" value="authorize">
      </div>
    </form>
    <div>
      <button onclick="window.location.href='/eatfood/registration.html';" class="b-btn">Registration</button>
    </div>
    <script>
    function logIn(e) {
	e.preventDefault();
	var body = "login="+encodeURIComponent(document.querySelector("input[name='login']").value)+"&"+
	    "password="+encodeURIComponent(document.querySelector("input[name='password']").value)
	var xhr = new XMLHttpRequest()
	xhr.open("post", "/eatfood/client/login")
	xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
	xhr.onload = () => {
	    if (xhr.status === 200 && xhr.responseText === 'true') {
		window.location.href = '/eatfood/index.html'
	    } else {
		let btnSubmit = document.querySelector("input[type='submit']");
		let oldColor = btnSubmit.style.backgroundColor;
		btnSubmit.style.backgroundColor = "hsl(0, 90%, 60%)";
		setTimeout( () => btnSubmit.style.backgroundColor = oldColor, 1000);
	    }
	}
	xhr.send(body);
    }
    </script>
  </body>
</html>
